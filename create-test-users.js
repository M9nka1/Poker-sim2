const bcrypt = require('bcrypt');
const database = require('./database/database');

async function createTestUsers() {
  try {
    // Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµĞ¼ Ğ±Ğ°Ğ·Ñƒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
    await database.init();
    
    console.log('ğŸ” Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ñ… Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹...');
    
    // Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ñ… Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹
    const testUsers = [
      { email: 'player1@test.com', password: 'Password123!', handLimit: 100 },
      { email: 'player2@test.com', password: 'Password123!', handLimit: 100 },
      { email: 'player3@test.com', password: 'Password123!', handLimit: 50 },
      { email: 'player4@test.com', password: 'Password123!', handLimit: 50 },
      { email: 'tester@gmail.com', password: 'Password123!', handLimit: 200 },
      { email: 'demo@test.com', password: 'demo123', handLimit: 1000 }
    ];
    
    for (const userData of testUsers) {
      try {
        // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼, ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚ Ğ»Ğ¸ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ
        const existingUser = await database.get(
          'SELECT user_id FROM Users WHERE email = ?',
          [userData.email]
        );
        
        if (existingUser) {
          console.log(`âš ï¸ ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ ${userData.email} ÑƒĞ¶Ğµ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚`);
          continue;
        }
        
        // Ğ¥ĞµÑˆĞ¸Ñ€ÑƒĞµĞ¼ Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ
        const hashedPassword = await bcrypt.hash(userData.password, 10);
        
        // Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
        await database.run(
          'INSERT INTO Users (user_id, email, password_hash, hand_limit) VALUES (?, ?, ?, ?)',
          [userData.email, userData.email, hashedPassword, userData.handLimit]
        );
        
        // ĞĞ°Ğ·Ğ½Ğ°Ñ‡Ğ°ĞµĞ¼ Ñ€Ğ¾Ğ»ÑŒ "Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ"
        await database.run(
          'INSERT INTO UserRoles (user_id, role_id) VALUES (?, ?)',
          [userData.email, 1] // role_id = 1 Ğ´Ğ»Ñ Ñ€Ğ¾Ğ»Ğ¸ "user"
        );
        
        console.log(`âœ… Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ: ${userData.email} (Ğ»Ğ¸Ğ¼Ğ¸Ñ‚: ${userData.handLimit})`);
        
      } catch (error) {
        console.error(`âŒ ĞÑˆĞ¸Ğ±ĞºĞ° ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ ${userData.email}:`, error.message);
      }
    }
    
    console.log('ğŸ‰ ĞŸÑ€Ğ¾Ñ†ĞµÑÑ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ñ… Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½!');
    console.log('');
    console.log('ğŸ“‹ Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚Ğ¾Ğ²:');
    console.log('â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”');
    console.log('â”‚ Email               â”‚ ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ          â”‚ Ğ›Ğ¸Ğ¼Ğ¸Ñ‚   â”‚');
    console.log('â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤');
    testUsers.forEach(user => {
      console.log(`â”‚ ${user.email.padEnd(19)} â”‚ ${user.password.padEnd(15)} â”‚ ${user.handLimit.toString().padEnd(7)} â”‚`);
    });
    console.log('â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜');
    console.log('');
    console.log('ğŸš€ Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ ÑÑ‚Ğ¸ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚Ñ‹ Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ² Ñ€Ğ°Ğ·Ğ½Ñ‹Ñ… Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğ°Ñ…!');
    
  } catch (error) {
    console.error('âŒ ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¾ÑˆĞ¸Ğ±ĞºĞ°:', error);
  } finally {
    await database.close();
    process.exit(0);
  }
}

// Ğ—Ğ°Ğ¿ÑƒÑĞº ÑĞºÑ€Ğ¸Ğ¿Ñ‚Ğ°
createTestUsers(); 