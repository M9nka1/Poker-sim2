# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ $NaN –≤ HandHistory

## üö® –ü—Ä–æ–±–ª–µ–º–∞
–í —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö HandHistory –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã —Å–µ—Ä—å–µ–∑–Ω—ã–µ –æ—à–∏–±–∫–∏:

```
11: raises $NaN to $NaN
44: raises $NaN to $NaN
11: raises $NaN to $NaN
```

### –ü—Ä–∏—á–∏–Ω—ã –æ—à–∏–±–æ–∫:

1. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–µ–π–∑–æ–≤** - –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `addAction()` –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å –ø–æ–ª—è `raiseAmount` –∏ `totalBet`
2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤ formatAction()** - —Ñ—É–Ω–∫—Ü–∏—è –æ–∂–∏–¥–∞–ª–∞ —ç—Ç–∏ –ø–æ–ª—è, –Ω–æ –æ–Ω–∏ –±—ã–ª–∏ `undefined`
3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–±–µ–ª–∞** –º–µ–∂–¥—É –∫–æ–Ω—Ü–æ–º –ø—Ä–µ—Ñ–ª–æ–ø–∞ –∏ –Ω–∞—á–∞–ª–æ–º —Ñ–ª–æ–ø–∞

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –§—É–Ω–∫—Ü–∏—è `addAction()` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–µ–π–∑–æ–≤
```javascript
// –î–ª—è —Ä–µ–π–∑–æ–≤ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
if (actionType === 'raise') {
  action.raiseAmount = finalAmount - this.currentBet; // –†–∞–∑–º–µ—Ä —Ä–µ–π–∑–∞
  action.totalBet = finalAmount; // –û–±—â–∞—è —Å—Ç–∞–≤–∫–∞
  action.previousBet = this.currentBet; // –ü—Ä–µ–¥—ã–¥—É—â–∞—è —Å—Ç–∞–≤–∫–∞
}

// –î–ª—è –∫–æ–ª–ª–∞ —Ç–æ–∂–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
if (actionType === 'call') {
  action.callAmount = finalAmount; // –†–∞–∑–º–µ—Ä –∫–æ–ª–ª–∞
}

// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ all-in
if (player.stack <= finalAmount) {
  action.allIn = true;
}
```

### 2. –§—É–Ω–∫—Ü–∏—è `formatAction()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–π–∑–æ–≤ —Å fallback
```javascript
case 'raise':
  const raiseAllInText = action.allIn ? ' and is all-in' : '';
  
  // –ï—Å–ª–∏ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –æ —Ä–µ–π–∑–µ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏—Ö
  if (action.raiseAmount !== undefined && action.totalBet !== undefined) {
    return `${playerName}: raises $${(action.raiseAmount / 100).toFixed(2)} to $${(action.totalBet / 100).toFixed(2)}${raiseAllInText}\n`;
  } else {
    // Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –µ—Å–ª–∏ raiseAmount –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
    // –í—ã—á–∏—Å–ª—è–µ–º —Ä–∞–∑–º–µ—Ä —Ä–µ–π–∑–∞ –∏–∑ –æ–±—â–µ–π —Å—Ç–∞–≤–∫–∏
    const previousBet = action.previousBet || 0;
    const raiseSize = amount - previousBet;
    return `${playerName}: raises $${(raiseSize / 100).toFixed(2)} to $${(amount / 100).toFixed(2)}${raiseAllInText}\n`;
  }
```

### 3. –§—É–Ω–∫—Ü–∏—è `generateHandHistoryText()` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```javascript
// –£–±–µ–∂–¥–∞–µ–º—Å—è —á—Ç–æ –ø—Ä–µ—Ñ–ª–æ–ø –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –ø–µ—Ä–µ–Ω–æ—Å–æ–º —Å—Ç—Ä–æ–∫–∏
if (!handText.endsWith('\n')) {
  handText += '\n';
}
```

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π HandHistory –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:

**–î–æ (—Å –æ—à–∏–±–∫–∞–º–∏):**
```
Pio_IP_c3bBU: calls $85.00*** FLOP *** [9s Th 4s]
11: raises $NaN to $NaN
44: raises $NaN to $NaN
```

**–ü–æ—Å–ª–µ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ):**
```
Pio_IP_c3bBU: calls $85.00
*** FLOP *** [9s Th 4s]
11: bets $57.50
44: raises $57.50 to $115.00
11: raises $115.00 to $230.00
```

## üéØ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **All-in –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ `and is all-in` –∫ –¥–µ–π—Å—Ç–≤–∏—è–º
2. **–î–∞–Ω–Ω—ã–µ –∫–æ–ª–ª–æ–≤** - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ `callAmount` –¥–ª—è –ª—É—á—à–µ–π –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏
3. **Fallback –º–µ—Ö–∞–Ω–∏–∑–º** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä: `node server.js`
2. –°–æ–∑–¥–∞–π—Ç–µ —Å–µ—Å—Å–∏—é –∏ —Å—ã–≥—Ä–∞–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä—É–∫
3. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ HandHistory –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫–µ `handhistory/`
4. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—Å–µ —Ä–∞–∑–º–µ—Ä—ã —Å—Ç–∞–≤–æ–∫ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏ –Ω–µ –Ω–∞—Ä—É—à–∞—é—Ç —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã. 