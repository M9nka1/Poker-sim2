# üîê –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

## üìä –û–±—â–∏–π —Å—Ç–∞—Ç—É—Å
‚úÖ **–°–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —É—Å–ø–µ—à–Ω–æ –≤–Ω–µ–¥—Ä–µ–Ω–∞ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞**

## üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Å—Ç–æ–≤

### ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ —Ç–µ—Å—Ç—ã:
1. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** - ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç (500 –æ—à–∏–±–∫–∞ –¥–ª—è –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ)
2. **–ü–æ–≤—Ç–æ—Ä–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è** - ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è (409 —Å—Ç–∞—Ç—É—Å)
3. **–í—Ö–æ–¥ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏** - ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç JWT —Ç–æ–∫–µ–Ω
4. **–í—Ö–æ–¥ —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –ø–∞—Ä–æ–ª–µ–º** - ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è (401 —Å—Ç–∞—Ç—É—Å)
5. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ access —Ç–æ–∫–µ–Ω–∞** - ‚úÖ Refresh token —Ä–∞–±–æ—Ç–∞–µ—Ç
6. **–ó–∞—â–∏—â–µ–Ω–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç (logout)** - ‚úÖ –¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
7. **–í–∞–ª–∏–¥–∞—Ü–∏—è —Å–ª–∞–±–æ–≥–æ –ø–∞—Ä–æ–ª—è** - ‚úÖ –ë–ª–æ–∫–∏—Ä—É–µ—Ç —Å–ª–∞–±—ã–µ –ø–∞—Ä–æ–ª–∏

### ‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ:
- **Rate limiting** –∞–∫—Ç–∏–≤–µ–Ω - –ø—Ä–∏ —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è 429 —Å—Ç–∞—Ç—É—Å
- –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –∞—Ç–∞–∫

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

### üìÅ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ —Å—Ö–µ–º–∞:
- `database/database.js` - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ SQLite
- `database/schema.sql` - –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- `scripts/init-database.js` - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
- `scripts/create-admin.js` - –°–æ–∑–¥–∞–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

### üîí –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:
- `middleware/auth.js` - Middleware –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–∫–µ–Ω–æ–≤
- `routes/auth.js` - –ú–∞—Ä—à—Ä—É—Ç—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- `server-with-auth.js` - –°–µ—Ä–≤–µ—Ä —Å –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π

### üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
- `test-auth-api.js` - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã API
- `test-frontend.html` - –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## üìã API Endpoints

### üîì –ü—É–±–ª–∏—á–Ω—ã–µ:
- `POST /api/auth/register` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- `POST /api/auth/login` - –í—Ö–æ–¥
- `POST /api/auth/token/refresh` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞

### üîí –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ (—Ç—Ä–µ–±—É—é—Ç —Ç–æ–∫–µ–Ω):
- `GET /api/me` - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
- `GET /api/me/hands` - –ò—Å—Ç–æ—Ä–∏—è —Ä–∞–∑–¥–∞—á –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `GET /api/me/hands/:id/download` - –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ä–∞–∑–¥–∞—á–∏
- `POST /api/game/play` - –ò–≥—Ä–∞ —Ä–∞–∑–¥–∞—á–∏ (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ª–∏–º–∏—Ç–∞)
- `POST /api/auth/logout` - –í—ã—Ö–æ–¥

### üëë –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—Å–∫–∏–µ:
- `GET /api/admin/users` - –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `POST /api/admin/users/:id/limit` - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ª–∏–º–∏—Ç–∞ —Ä–∞–∑–¥–∞—á
- `GET /api/admin/hands/all/download` - –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö —Ä–∞–∑–¥–∞—á

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:
```bash
npm install
```

### 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
```bash
npm run init-db
```

### 3. –°–æ–∑–¥–∞–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:
```bash
npm run create-admin
# –∏–ª–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
npm run create-admin admin@example.com MyPassword123!
```

### 4. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞:
```bash
node server-with-auth.js
```

### 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã
node test-auth-api.js

# –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
http://localhost:3001/test-frontend.html
```

## üöÄ –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ

### –¢–µ—Å—Ç–æ–≤—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä:
- **Email:** admin@pokersimu.com
- **–ü–∞—Ä–æ–ª—å:** AdminPassword123!
- **–õ–∏–º–∏—Ç —Ä–∞–∑–¥–∞—á:** 1000
- **–†–æ–ª–∏:** user, admin

### –¢–µ—Å—Ç–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (—Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏):
- **Email:** test@example.com
- **–ü–∞—Ä–æ–ª—å:** Password123!
- **–õ–∏–º–∏—Ç —Ä–∞–∑–¥–∞—á:** 0 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- **–†–æ–ª–∏:** user

## üîê –§—É–Ω–∫—Ü–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- JWT —Ç–æ–∫–µ–Ω—ã —Å –∏—Å—Ç–µ—á–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏
- Refresh —Ç–æ–∫–µ–Ω—ã –≤ HttpOnly cookies
- –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π (bcrypt)
- Rate limiting (15 –º–∏–Ω—É—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- Helmet security headers
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ —Ä–∞–∑–¥–∞—á

üîí **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:**
- HTTPS –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
- –ë–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∏–µ CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- Backup –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** SQLite (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
- **–ò–Ω–¥–µ–∫—Å—ã:** –°–æ–∑–¥–∞–Ω—ã –¥–ª—è email, user_id, role lookups
- **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ:** JWT —Ç–æ–∫–µ–Ω—ã –≤ –ø–∞–º—è—Ç–∏ –∫–ª–∏–µ–Ω—Ç–∞
- **–°–∂–∞—Ç–∏–µ:** Gzip compression –≤–∫–ª—é—á–µ–Ω–æ

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **Google OAuth integration** (Stage 2)
2. **Frontend dashboard** —Å React/Vue
3. **Advanced admin panel** 
4. **Hand history analytics**
5. **PostgreSQL migration** –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

---

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üöÄ

–ó–∞–ø—É—Å–∫: `node server-with-auth.js`  
–¢–µ—Å—Ç—ã: `node test-auth-api.js`  
–í–µ–±-—Ç–µ—Å—Ç—ã: `http://localhost:3001/test-frontend.html` 